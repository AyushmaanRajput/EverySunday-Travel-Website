<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <!-- Favicon Icon -->
    <link rel="icon" type="image/x-icon" href="/assets/brand-icon.svg">

    <!-- Font Awesome CDN -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" integrity="sha512-iecdLmaskl7CVkqkXNQ/ZH/XLlvWZOJyj7Yy7tcenmpD1ypASozpmT/E0iPtmFIB46ZmdtAc9eNBvH0H/ZpiBw==" crossorigin="anonymous" referrerpolicy="no-referrer" />

    <!-- Links To All Style Files -->
    <link rel="stylesheet" href="./main.css">

    <title>Every Sunday | Feedback</title>

    <style>
        /* Add your CSS here(optional) */
        #testimonials-main{
            display: grid;
            grid-template-columns: repeat(3,1fr);
            gap:2rem;
        }
    </style>
</head>
<body>
    <header>
        <nav class="container">
            <img src="./assets/brand-logo.svg" alt="Every Sunday Logo">
            <ul>
                <li><a href="/">Home</a></li>
                <li><a href="/">Destination</a></li>
                <li><a href="/">Feedback</a></li>
                <li><a href="/">Pricing</a></li>
            </ul>
            <i class="fa-solid fa-user"></i>
        </nav>
    </header>
    <main>
        <section class="container">
            <!-- Write Your HTML Code here -->
            <div id="testimonials-main">

            </div>
            <label for="name">Name:</label>
            <input type="text" id="name" placeholder="Enter Your Name" required>
            <label for="rating">Rating:</label>
            <input type="number" id="rating" min="1" max="5" placeholder="Enter Your Rating" required><br><br>

            <label for="review">Feedback:</label>
            <textarea name="review" id="review"  placeholder="Enter your Feedback"></textarea>
            <button class="btn">Post</button>
            <!-- -->
        </section>
    </main>
    <footer>
        <section class="articles"></section>
        <div class="container">
            <h1>Get started and early <span>Update</span> about our package</h1>
            <!-- Copy this searchbox If you want to use it somewhere else -->
            <div class="searchbox">
                <input  type="text" placeholder="Enter your email">
                <button class="btn">Get Started</button>
            </input>
            </div>
            <hr>
            <div class="footer">
                <img src="./assets/brand-logo.svg" alt="Every Sunday Logo">
                <ul>
                    <li><a href="/">Home</a></li>
                    <li><a href="/">Destination</a></li>
                    <li><a href="/">Feedback</a></li>
                    <li><a href="/">Pricing</a></li>
                </ul>
                <p><i class="fa-regular fa-copyright"></i> 2023 Every Sunday</p>
            </div>
            <div class="socials">
                <div class="social">
                    <i class="fa-brands fa-instagram"></i>
                </div>
                <div class="social"><i class="fa-brands fa-twitter"></i></div>
                <div class="social">
                    <i class="fa-brands fa-facebook"></i>
                </div>
            </div>
        </div>
    </footer>
    
</body>
</html>
<script>
    // Write all you JS code below
    // target all the elements
    let url = `https://mock-api-server-r9e5.onrender.com/testimonials`;
    let testimonials_main = document.querySelector('#testimonials-main');
    let name = document.getElementById('name');
    let rating = document.getElementById('rating');
    let textarea = document.getElementById('review');
    let postBtn = document.querySelector('.btn');

    postBtn.addEventListener('click',postData);

    async function postData(){
        try{
            let userdata = {
                name:name.value,
                rating:rating.value,
                review:textarea.value,
            }
            let response = await fetch(url,{
                method:'POST',
                headers:{
                    "Content-type":"application/json",
                },
                body:JSON.stringify(userdata)
            });
            let data = await response.json();
            fetchtestimonials(url);
            console.log(data); 
        }
        catch(error){

        }
    }

    // window.addEventListener('load',fetchtestimonials)

    async function fetchtestimonials(url){
        try{
            let response = await fetch(url);
            let testimonialsData = await response.json();
            console.log(testimonialsData)
            displaytestimonials(testimonialsData)
        }
        catch(error){
            console.log(error);
            
        }
    }
    fetchtestimonials(url);
    function displaytestimonials(data){
            testimonials_main.innerHTML=null;
            data.forEach(item => {
                let card = createTestimonialsCard(item);
                testimonials_main.append(card);
            });
    }
    function createTestimonialsCard(item){
        let card = document.createElement('div');
        card.className = 'card';

        let avatar = document.createElement('img');
        // avatar.src=item.imgAvatar;
        avatar.className = 'avatar';

        let headName = document.createElement('div');
        headName.className = 'headName';

        let name = document.createElement('h3');
        name.className = 'name';
        name.textContent = item.name;

        let rating = document.createElement('h3');
        rating.className = 'rating';
        rating.textContent = item.rating+'‚≠ê';

        let review = document.createElement('p');
        review.className = 'review';
        review.textContent = item.review;

        let postTestimonials = document.createElement('button');
        postTestimonials.className = 'postTestimonials'
        postTestimonials.textContent = 'Post'
        headName.append(name,rating);
        card.append(avatar,headName,review);
        return card;
    }
</script>
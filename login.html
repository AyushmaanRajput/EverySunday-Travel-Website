<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <!-- Favicon Icon -->
    <link rel="icon" type="image/x-icon" href="/assets/brand-icon.svg">

    <!-- Font Awesome CDN -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" integrity="sha512-iecdLmaskl7CVkqkXNQ/ZH/XLlvWZOJyj7Yy7tcenmpD1ypASozpmT/E0iPtmFIB46ZmdtAc9eNBvH0H/ZpiBw==" crossorigin="anonymous" referrerpolicy="no-referrer" />

    <!-- Links To All Style Files -->
    <link rel="stylesheet" href="./main.css">

    <title>Every Sunday | Login </title>

    <style>
        /* Add your CSS here(optional) */
        *{
            color: white;
        }
        #box{
            width: 450px;
            border: 5px solid whitesmoke;
            margin: auto;
            text-align: center;
            margin-block: 40px;
            border-radius: 30px;
        }
        .logSignTogle{
            margin: 1rem 0;
            display: flex;
            justify-content: space-evenly;
        }
        .main{
            display: flex;
            margin-bottom: 30px;
            margin-top: 30px;
            justify-content: center;
        }
        
        .signup-page {
            display: none;
        }
        .container > div:nth-child(1){
            width: 400px;
            margin: auto;
        }
        h3{
            margin-bottom: 20px;
            color: var(--highlight);
            font-family: sans-serif;
        }
        input{
            padding: 0.5rem 1rem ;
            color:grey;
            border-radius: 50px;
        }
        #log,#sign{
            border-radius: 20px;
            background-color: var(--primary); 
            color: white;
            padding: 5px 10px;
        }
        .form-group {
            margin-bottom: 20px;
            display: flex;
            align-items: center;
        }

        .form-group label {
            flex-basis: 100px;
            margin-right: 10px;
        }

        .form-group input {
            flex-grow: 1;
            /* padding: 5px; */
        }
    </style>
</head>
<body>
    <header>
        <nav class="container">
            <img src="./assets/brand-logo.svg" alt="Every Sunday Logo">
            <ul>
                <li><a href="/index.html">Home</a></li>
                <li><a href="/destination.html">Destination</a></li>
                <li><a href="/feedback.html">Feedback</a></li>
                <li><a href="/prices.html">Pricing</a></li>
            </ul>
            <!-- <div id="toggle">
                <label class="switch">
                    <input type="checkbox">
                    <span class="slider round"></span>
                </label>
            </div> -->
            <div id="login-container">
                <a href="./login.html" id="loginBtn"><i class="fa-solid fa-user" id="login-btn"></i></a>
                <div style="display: none;">
                    <a href='./checkout.html'><i class="fa-solid fa-cart-shopping" style="margin-right:1rem"></i></a>
                    <a href="/" id="logout-btn" class='btn-small' style='border-radius:50px;color:var(--white)'>Log Out</a>
                </div>       
            </div>
        </nav>
    </header>
    <main>
        <section class="container">
            <!-- Write Your HTML Code here -->
            <div id="box">

                <div class="logSignTogle">
                    <button onclick="showLogin()" class="btn">Login Tab</button>
                    <button onclick="showSignup()" class="btn">Signup Tab</button>
                </div>
                
                
                <div class="main">
                    <!-- Add login page details here -->

        
                    <div id="login" class="login-page">
                        <h3>Login Page</h3>
        
                        <form id="loginform">
        
                            <div class="form-group">
                                <label for="email1">Email:</label>
                                <input type="email" id="email1" name="email1" autocomplete="off" placeholder="Enter email">
                            </div>
        
                            <div class="form-group">
                                <label for="password">Password:</label>
                                <input type="password" id="passwordl" name="password" placeholder="Enter password">
                            </div>
        
                            <input type="submit" value="Login" id="log" class="btn">
        
                        </form>
                
                    </div>
                    <!-- Add signup page details here -->
        
        
                    <div id="signup" class="signup-page">
        
                        <h3>Signup Page</h3>
        
                        <form id="signupform">
        
                            <div class="form-group">
                                <label for="name">Name:</label>
                                <input type="text" id="name" name="name" autocomplete="off" placeholder="Enter your name">
                            </div>
        
                            <div class="form-group">
                                <label for="email">Email:</label>
                                <input type="email" id="email" name="email" autocomplete="off" placeholder="Enter email">
                            </div>
                            
                            <div class="form-group">
                                <label for="dob">Date of Birth:</label>
                                <input type="date" id="dob" name="dob" autocomplete="off">
                              </div>
                              
                            <div class="form-group">
                                <label for="password">Password:</label>
                                <input type="password" id="passwords" name="password" placeholder="Enter password">
                            </div>
        
                            <div class="form-group">
                                <label for="confirm-password">Confirm Password:</label>
                                <input type="password" id="confirm-password" name="confirm-password" placeholder="Confirm your password">
                            </div>
        
                            <input type="submit" value="Signup" class="btn" id="sign">
        
                        </form>
                    </div>
                </div>

            </div>

            <!-- -->
        </section>
    </main>
    <footer>
        <section class="articles"></section>
        <div class="container">
            <h1>Get started and early <span>Update</span> about our package</h1>
            <!-- Copy this searchbox If you want to use it somewhere else -->
            <div class="searchbox">
                <input  type="text" placeholder="Enter your email">
                <button class="btn" id="cta">Get Started</button>
            </input>
            </div>
            <hr>
            <div class="footer">
                <img src="./assets/brand-logo.svg" alt="Every Sunday Logo">
                <ul>
                    <li><a href="/">Home</a></li>
                    <li><a href="/">Destination</a></li>
                    <li><a href="/">Feedback</a></li>
                    <li><a href="/">Pricing</a></li>
                </ul>
                <p><i class="fa-regular fa-copyright"></i> 2023 Every Sunday</p>
            </div>
            <div class="socials">
                <div class="social">
                    <a href="https://www.instagram.com/" target="_blank"><i class="fa-brands fa-instagram"></i></a>
                </div>
                <div class="social">
                    <a href="https://twitter.com/" target="_blank"><i class="fa-brands fa-twitter"></i></a>
                </div>
                <div class="social">
                    <a href="https://www.facebook.com/" target="_blank"><i class="fa-brands fa-facebook"></i></a>
                </div>
            </div>
        </div>
    </footer>
    
</body>
</html>
<script src="main.js"></script>
<script>
    // Write all you JS code below
    <!-- Your HTML code remains the same -->


    // Write all your JS code below
    function showLogin() {
        document.getElementById("login").style.display = "block";
        document.getElementById("signup").style.display = "none";
    }

    function showSignup() {
        document.getElementById("login").style.display = "none";
        document.getElementById("signup").style.display = "block";
    }

    let login_data = [];

    async function fetchData() {
        try {
            let res = await fetch("https://mock-every-sunday-server.onrender.com/users");
            let data = await res.json();
            console.log(data);
            login_data = data;
        } catch (err) {
            console.log(err);
        }
    }
    fetchData();

    let form1 = document.getElementById("signupform");
    let name = document.getElementById("name");
    let email = document.getElementById("email");
    let dob=document.getElementById("dob")
    let password = document.getElementById("passwords");
    let confirmPassword = document.getElementById("confirm-password");

    form1.addEventListener("submit", function(event) {
        event.preventDefault();

        if (confirmPassword.value !== password.value) {
            alert("Enter the same characters for password and confirm password fields!");
        } else {
            signup();
        }
    },{once: true});

    async function signup() {
        try {
            let res = await fetch("https://mock-every-sunday-server.onrender.com/users", {
                method: "POST",
                body: JSON.stringify({
                    name: name.value,
                    email: email.value,
                    password: password.value,

                    dob: dob.value,
                    imgAvatar : Math.floor((Math.random() * 10)+1)

                  
                }),
                headers: {
                    "Content-Type": "application/json"
                }
            });

            let data = await res.json();
            fetchData();
            displayMessage("User SignIn Successfull!", "success")
            console.log(data);
        } catch (err) {
            console.log(err);
        }
    }

    let email1 = document.getElementById("email1");
    let passwordLogin = document.getElementById("passwordl");
    let form2 = document.getElementById("loginform");
// console.log(login_data)

form2.addEventListener("submit", function(event) {
  event.preventDefault();

  let flag = false;

  for (let i = 0; i < login_data.length; i++) {
    if (email1.value === login_data[i].email && passwordLogin.value === login_data[i].password) {
      // User logged in successfully.
      flag = true;
      if (email1.value === "admin@admin.com" && passwordLogin.value === "admin") {
        displayMessage('Admin Login Successfull','success');  
          console.log('Admin logged In');
          setTimeout(()=>{
              window.location.href="admin.html";
          },2000)
    
      } else {
        displayMessage('User Login Successfull','success'); 
        // Redirect to the regular user page (change "admin.html" to the appropriate user page).
        localStorage.setItem('userId', login_data[i].id);
        console.log('User logged In'); 
        setTimeout(()=>{
            window.location.href="index.html";
        },2000);
      }
      break;
    }
}

if (!flag) {
    displayMessage('Wrong Credentials! Try Again.','warning');
}
email1.value="";
passwordLogin.value="";
});

</script>
